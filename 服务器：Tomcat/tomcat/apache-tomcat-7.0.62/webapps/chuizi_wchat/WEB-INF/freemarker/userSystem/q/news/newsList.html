<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <link rel="stylesheet" href="${ctx}/js/userSystem/css/base.css">
    <link rel="stylesheet" href="${ctx}/js/userSystem/css/server-show.css">
    <link rel="stylesheet" href="http://at.alicdn.com/t/font_436970_h15ug20rer9kke29.css">
    <link rel="stylesheet" href="${ctx}/js/userSystem/img/sprite.css">
    <link rel="stylesheet" href="${ctx}/js/userSystem/css/animate.min.css">
</head>
<body>
<div class="main animated rotateInUpLeft">
    <form >
        <!--菜单选择-->
        <div id="menus">
            <ul class="menus-tab clearfix">
                <li id="qnewsHtml" >
                    参数设置
                </li>
                <li id="qnewsCategory">
                    新闻分类
                </li>
                <li class="active-top" id="qnewsId">
                    新闻中心
                </li >
            </ul>
            
            <form class="form-horizontal" name="searchForm" id="searchForm" action="/chuizi_wchat/userSystem/good/list/pre" role="form"> 
          <input type="hidden" name="miniBinId" id="miniBinId" value="${(returnDatas.queryBean.miniBinId)!'1'}"/>
           <input type="hidden" name="pageIndex" id="pageIndex" value="${(returnDatas.page.pageIndex)!'1'}"/>
       	 <div class="fn-box clearfix">
            <div class="fl">
                <span>标题名称</span>
                <input autocomplete="off" name="title" type="text" placeholder="请输入标题名称" value="${(returnDatas.queryBean.title)!''}">
            </div>
                
		            <div class="fl">
		                <span>分类</span>
		                <select name="categoryId" id="categoryId">
		                </select>
		            </div>
            <button onclick="$('#pageIndex').val(1)"  class="btnH" href="javascript:mySubmitForm('searchForm');" id="search">查询</button>
            <button class="btnH" href="javascript:mySubmitForm('searchForm');" id="searchPage" style="display: none;">分页查询</button>
            <button class="btnD">重置</button>
        </div>
        </form>
        </div>
        <div style="height: 12px"></div>
        <ul class="mainS">
            
            <li>
                <div class="btn-b newsListAddHtml" style="margin: 10px 0 20px;">新增</div>
                 <table>
                      <thead>
						<tr>
						 <!--first_start_no_export-->
						 <!--first_end_no_export-->
								<th id="th_cityId" >操作</th>
								<th id="th_position" >新闻标题</th>
								<th id="th_itemId" >新闻图标</th>
								 <th id="th_url" >创建时间</th>
								<th id="th_cityId" >查看量</th>
								<th id="th_cityId" >分类名称</th>
								<th id="th_cityId" >是否推荐到首页</th>
						</tr>
					</thead>
					
                    

				        <#if (returnDatas.data??)&&(returnDatas.data?size>0)>
		                <#list returnDatas.data as _data>
						 
							<tr id="${_data.id}">
							
							
								<td >
										<a href="#"  class="btn btn-danger btn-xs" itemId="${_data.id}">删除 </a>
										<a href="#" updateItemId="${_data.id}" class="btn btn-primary btn-xs newsListAddHtml" data-target=" ">编辑</a>
								</td>
								<td >
										${(_data.title)!''}
								</td>
								<td >
										<img style="width: 300px;height: 150px;" src="${(_data.icon)!''}">
								</td>
								
								
								<td >
										${(_data.createTime)!''}
								</td>
								
								<td >
										${(_data.lookNum)!'0'}
								</td>
								
								<td >
										${(_data.categoryName)!''}
								</td>
								
								<td ><#if _data.isRecommend??><#if _data.isRecommend==1><i itemId="${(_data.id)!''}" class="iconfont active">&#xe601;</i><#else><i itemId="${(_data.id)!''}" class="iconfont">&#xe601;</i></#if></#if></td>
								
							</tr>
							
						</#list>
						 </#if>
						
                </table>
                <div class="pages clearfix">
                    <div id="pagination1" class="pages-list">
                    </div>
                </div>
                <!--新增-->

            </li>
        </ul>
    </form>
    <!--是否删除弹窗-->
    <div class="alert-warn-box" id="rem">
        <div class="alert-warn cen">
            <h4>是否确认进行删除？删除后不可进行恢复。</h4>
            <div class="btn-box clearfix" style="margin-left: 0;">
                <div class="oks fl" onclick="deleteInfo();">
                    确定
                </div>
                <div class="cancel fr" onclick="javascript:$('.alert-warn-box').toggle()">
                    取消
                </div>
            </div>
        </div>
    </div>
</div>
</body>
<script src="${ctx}/js/userSystem/lib/jquery-1.8.3.min.js"></script>
<script src="${ctx}/js/userSystem/lib/jquery.pagination.min.js"></script>
<script src="${ctx}/js/userSystem/js/pulic.js"></script>
<script>
    $(function () {
        $("ul.menus-tab li").on("click",function () {
            $(this).addClass("active-top").siblings().removeClass("active-top");
            $("ul.mainS li").eq($(this).index()).show().siblings().hide();
            $("form").each(function (item) {
                this.reset()
            });
            $(".add-txt").hide().siblings().show()
        });
        $(".btn-b").on("click",function () {
            $(this).siblings('.add-txt').show().siblings().hide();
        });
        //        页码
    $("#pagination").pagination({
        currentPage:${(returnDatas.page.pageIndex)!1},// 当前页数
        totalPage:${(returnDatas.page.pageCount)!1},// 总页数
        count: 5,// 显示个数
        callback: function (num) {
        	$("#pageIndex").val(num);
        	$("#searchPage").click();
        }
    });
       
        $("table td i").click(function () {
        	$(this).toggleClass("active");
        	$.ajax({
				url : '/chuizi_wchat/system/qtmplnews/isRecommend/json?id='+$(this).attr("itemId"),
				type : "get",
				success : function(result){
					$("#searchPage").click();
				},
				error:function(XMLHttpRequest,textStatus,errorThrown){
					console.log(XMLHttpRequest);
					console.log(textStatus);
				}
			});
        	
   		});
        $(".mode-add .oks").click(function () {
            $(this).parents(".mode-add").toggle().siblings().toggle();
            alert("添加")
        });
        $(".addT .oks").click(function () {
            $('.addT .add-txt').toggle().siblings().toggle();
            alert("提交")
        });
         $(".btn-danger").on("click",function(){
    	$("#rem").toggle();
    	$("#rem").attr("itemId",$(this).attr("itemId"));
    });
    });
    
    //删除按钮
        function deleteInfo(){
        
        	$.ajax({
				url : '/chuizi_wchat/userSystem/qnews/del/more?id='+$("#rem").attr("itemId"),
				type : "get",
				success : function(result){
					$("#searchPage").click();
				},
				error:function(XMLHttpRequest,textStatus,errorThrown){
					console.log(XMLHttpRequest);
					console.log(textStatus);
				}
			});
        
        }
     //查询下拉单
   		selectInfo("/chuizi_wchat/system/qtmplnewscategory/list/json?pageSize=1000&miniBinId="+getCookie('miniBinId'),"categoryId",${(returnDatas.queryBean.categoryId)!''});
   		
   		//回选 下拉框
		jQuery("#type option[value='${(returnDatas.queryBean.stars)!''}']").prop("selected",true);
</script>
</html>