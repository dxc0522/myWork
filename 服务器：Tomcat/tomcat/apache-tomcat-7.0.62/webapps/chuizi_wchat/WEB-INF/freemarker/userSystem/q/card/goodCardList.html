<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <link rel="stylesheet" href="${ctx}/js/userSystem/css/base.css">
    <link rel="stylesheet" href="${ctx}/js/userSystem/css/server-show.css">
    <link rel="stylesheet" href="http://at.alicdn.com/t/font_436970_7zkkyo61s6c7hkt9.css">
    <link rel="stylesheet" href="${ctx}/js/userSystem/img/sprite.css">
    <link rel="stylesheet" href="${ctx}/js/userSystem/css/animate.min.css">
</head>
<body style="padding-top: 60px;">
<!-- <div class="help-warn">
    <span>如果你对该模块的配置不太了解可以先导入演示数据</span>
    <b>一键导入</b>
</div> -->
<div class="main animated rotateInUpLeft">
    <!--菜单选择-->
    <div id="menus">
        <ul class="menus-tab clearfix">
            <li  id="goodCardHtml" class="active-top">
                产品优惠券
            </li>
                 <li  id="userCardHtml" >
                用户优惠券
            </li>
        </ul>
         <form class="form-horizontal" name="searchForm" id="searchForm" action="${ctx}/userSystem/qgoodcard/list/pre" role="form"> 
          <input type="hidden" name="miniBinId" id="miniBinId" value="${(returnDatas.queryBean.miniBinId)!'1'}"/>
          <input type="hidden" name="pageIndex" id="pageIndex" value="${(returnDatas.page.pageIndex)!'1'}"/>
       	 	<div class="fn-box clearfix">
            <div class="fl">
                <span>优惠券名称</span>
                <input autocomplete="off" name="title" type="text" placeholder="请输入优惠券名称" value="${(returnDatas.queryBean.title)!''}">
            </div>
            
            <div class="fl">
		                <span>是否新人赠送</span>
		                <select name="isNew" id="isNew">
		                	<option value=''>全部</option>
		                    <option value='1'>新人赠送</option>
		                    <option value='0'>非新人赠送</option>
		                </select>
		            </div>
		            <div class="fl">
		                <span>优惠券种类</span>
		                <select name=type id="type">
		                	<option value=''>全部</option>
		                    <option value='1'>满减优惠券</option>
		                    <option value='2'>折扣优惠券</option>
		                    <option value='3'>无限制优惠券</option>
		                    
		                </select>
		            </div>
            <button onclick="$('#pageIndex').val(1)"  class="btnH" href="javascript:mySubmitForm('searchForm');" id="search">查询</button>
            <button class="btnH" href="javascript:mySubmitForm('searchForm');" id="searchPage" style="display: none;">分页查询</button>
            <button class="btnD">重置</button>
        </div>
        </form>
    </div>
    <div style="height: 12px"></div>
    <!--主要内容-->
    <ul class="mainS">
        <li>
                <!--数据展示-->
                <div class="show-data clearfix">
                    <div class="data-l fl">
                    <i class="iconfont icon-shuju1"></i>
                    <span>统计数据</span>
                    </div>
                    <div class="data-r fr">
                        总用户量：<span>948</span>人　　总金额：<span>12532465.54</span>
                    </div>
                </div>
            <div  class="btn-b goodCardAddHtml" style="margin: 10px 0 20px;">新增</div>
                <table>

                
                    <thead>

										<tr>
												<th id="th_cityId" >操作</th>
												<th id="th_cityId" >序号</th>
												<th id="th_position" >名称</th>
												<th id="th_itemId" >优惠券种类</th>
												<th id="th_url1" >内容</th>
												<th id="th_url" >有效时常</th>
												<th id="th_cityId" >是否新人赠送</th>
												<th id="th_cityId" >金额</th>
												<th id="th_cityId" >满多少</th>
												<th id="th_cityId" >减多少</th>
										</tr>
									</thead>
                   
							        <#if (returnDatas.data??)&&(returnDatas.data?size>0)>
					                <#list returnDatas.data as _data>
									 
										<tr id="${_data.id}">
										
											<td >
												<a href="#"  class="btn btn-danger btn-xs" itemId="${_data.id}">删除 </a>
												<a href="#" updateItemId="${_data.id}" class="btn btn-primary btn-xs goodCardAddHtml" data-target=" ">编辑</a>
											</td>
											<td >
													${(_data.id)!''}
											</td>
											<td >
													${(_data.title)!''}
											</td>
											<td ><#if _data.type??>
													<#if _data.type==1>满减
													<#elseif _data.type==2>折扣券
													<#elseif _data.type==3>无限制优惠券</#if></#if>
											</td>
											
											<td >
													${(_data.content)!''}
											</td>
											
											<td >
													${(_data.time)!''}
											</td>
											
											
											 <td ><#if _data.isNew??><#if _data.isNew==1><i itemId="${(_data.id)!''}" class="iconfont active">&#xe601;</i><#else><i itemId="${(_data.id)!''}" class="iconfont">&#xe601;</i></#if></#if></td>

											<td >
													${(_data.money)!''}
											</td>
											<td >
													${(_data.limitMoney)!''}
											</td>
											<td >
													${(_data.cutMoney)!''}
											</td>
										</tr>
									</#list>
									 </#if>
									
                </table>
                <div class="pages clearfix">
                    <div id="pagination" class="pages-list">
                    </div>
                </div>
           
        </li>
    </ul>
    
    
    <!--是否删除弹窗-->
    <div class="alert-warn-box" id="rem">
        <div class="alert-warn cen">
            <h4>是否确认进行删除？删除后不可进行恢复。</h4>
            <div class="btn-box clearfix" style="margin-left: 0;">
                <div class="oks fl" onclick="deleteInfo();">
                    确定
                </div>
                <div class="cancel fr" onclick="javascript:$('.alert-warn-box').toggle()">
                    取消
                </div>
            </div>
        </div>
    </div>
</div>
</body>
<script src="${ctx}/js/userSystem/lib/jquery-1.8.3.min.js"></script>
<script src="${ctx}/js/userSystem/lib/My97DatePicker/WdatePicker.js"></script>
<script src="${ctx}/js/userSystem/lib/jquery.pagination.min.js"></script>
<script src="${ctx}/js/userSystem/js/pulic.js"></script>
<script src="${ctx}/js/userSystem/lib/jquery.tmpl.min.js"></script>
<script>
    //        页码
    $("#pagination").pagination({
        currentPage:${(returnDatas.page.pageIndex)!1},// 当前页数
        totalPage:${(returnDatas.page.pageCount)!1},// 总页数
        count: 5,// 显示个数
        callback: function (num) {
        	$("#pageIndex").val(num);
        	$("#searchPage").click();
        }
    });
    $("table td i").click(function () {
        	$(this).toggleClass("active");
        	$.ajax({
				url : '/chuizi_wchat/system/qgoodcard/isNew/json?id='+$(this).attr("itemId"),
				type : "get",
				success : function(result){
					$("#searchPage").click();
				},
				error:function(XMLHttpRequest,textStatus,errorThrown){
					console.log(XMLHttpRequest);
					console.log(textStatus);
				}
			});
        	
   		});
    
  /*   $(".btn-b").on("click",function () {
        $(this).siblings('.add-txt').show().siblings().hide();
    }); */
    $("ul.menus-tab li").on("click",function () {
        $("ul.main-show li").eq($(this).index()).show().siblings().hide();
    });
    $(".btn-danger").on("click",function(){
    	$("#rem").toggle();
    	$("#rem").attr("itemId",$(this).attr("itemId"));
    });
    
   		 //回选 下拉框
		jQuery("#isNew option[value='${(returnDatas.queryBean.isNew)!''}']").prop("selected",true);
   		 //回选 下拉框
		jQuery("#type option[value='${(returnDatas.queryBean.type)!''}']").prop("selected",true);
		
		
		
		
		
		//删除按钮
        function deleteInfo(){
        
        	$.ajax({
				url : '/chuizi_wchat/userSystem/qgoodcard/del/more?id='+$("#rem").attr("itemId"),
				type : "get",
				success : function(result){
					$("#searchPage").click();
				},
				error:function(XMLHttpRequest,textStatus,errorThrown){
					console.log(XMLHttpRequest);
					console.log(textStatus);
				}
			});
        
        }
   
</script>
</html>